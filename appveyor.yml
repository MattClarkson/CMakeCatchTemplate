#/*============================================================================
#
#  MYPROJECT: A software package for whatever.
#
#  Copyright (c) University College London (UCL). All rights reserved.
#
#  This software is distributed WITHOUT ANY WARRANTY; without even
#  the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
#  PURPOSE.
#
#  See LICENSE.txt in the top level directory for details.
#
#============================================================================*/

version: "{build}"

os: Visual Studio 2015

init:
  - git config --global core.autocrlf input

clone_folder: c:\projects\CMakeCatchTemplate

shallow_clone: false

environment:
  matrix:
    - COMPILER: "Visual Studio 14 Win64"

configuration:
  - Release

matrix:
  - PYTHON: "C:\Python27"
    COMPILER: "Visual Studio 9"
    QT_ROOT: "C:\\Qt\\5.6\\msvc2015_64"
  - PYTHON: "C:\Python27-x64"
    COMPILER: "Visual Studio 9 Win64"
  - PYTHON: "C:\Python34"
    COMPILER: "Visual Studio 10"
  - PYTHON: "C:\Python34-x64"
    COMPILER: "Visual Studio 10 Win64"
  - PYTHON: "C:\Python35"
    COMPILER: "Visual Studio 14"
  - PYTHON: "C:\Python35-x64"
    COMPILER: "Visual Studio 14 Win64"
  - PYTHON: "C:\Python36"
    COMPILER: "Visual Studio 14"
  - PYTHON: "C:\Python36-x64"
    COMPILER: "Visual Studio 14 Win64"
  - PYTHON: "C:\Python37"
    COMPILER: "Visual Studio 15"
  - PYTHON: "C:\Python37-x64"
    COMPILER: "Visual Studio 15 Win 64"

before_build:
  - echo --------------------------------------------------------------------------------
  - echo Contents of C drive:
  - dir C:\
  - echo Appveyor environment info:
  - echo COMPILER = %COMPILER%, CONFIGURATION = %CONFIGURATION%
  - echo CMake information:
  - cmake -version
  - echo Current working dir:
  - pwd
  - git submodule update -q --init --recursive
  - set PATH=C:\Python36-x64;%PATH%
  - rem --------------------------------------------------------------------------------

build_script:
  - echo --------------------------------------------------------------------------------
  - echo Build CMakeCatchTemplate:
  - mkdir build
  - cd build
  - cmake -G "%COMPILER%" -DCMAKE_PREFIX_PATH="%QT_ROOT%" -DBUILD_SUPERBUILD:BOOL=ON -DBUILD_TESTING:BOOL=ON -DBUILD_Boost:BOOL=ON -DBUILD_Python_PyBind:BOOL=OFF -DBUILD_Python_Boost:BOOL=ON -DBUILD_Eigen:BOOL=OFF -DBUILD_glog:BOOL=OFF -DBUILD_gflags:BOOL=OFF -DBUILD_VTK:BOOL=OFF -DBUILD_PCL:BOOL=OFF -DBUILD_OpenCV:BOOL=OFF --config %CONFIGURATION% ..
  - cmake --build . --config %CONFIGURATION%

test_script:
  - pwd
  - cd MYPROJECT-build
  - pwd
  - ctest -C %CONFIGURATION%
